# Phase 0: 実装準備計画書 - 管理会社連携とテスト環境準備

## 📋 概要

### Phase 0の目的
- 管理会社との詳細確認・合意形成
- テスト環境の準備と検証
- 技術的制約の完全把握
- リスクの事前排除

### 期間
2025年2月1日 〜 2025年2月14日（2週間）

---

## 🏢 管理会社への質問・依頼事項一覧

### A. 技術環境に関する質問

#### 1. WordPress環境詳細
```
質問ID: WP-001
【質問】現在のWordPress環境について教えてください
- WordPressのバージョン: _____
- PHPのバージョン: _____
- MySQLのバージョン: _____
- 使用しているWebサーバー: □ Apache □ Nginx □ その他（　　）
- SSL証明書: □ Let's Encrypt □ 商用証明書 □ その他（　　）
```

#### 2. ACF Pro詳細
```
質問ID: ACF-001
【質問】ACF Proの使用状況について教えてください
- ACF Proのバージョン: _____
- フィールドグループ数: 約___個
- カスタムブロック使用: □ あり □ なし
- ACF拡張プラグイン: □ あり（名称：　　　　　） □ なし
```

#### 3. カスタム投稿タイプ詳細
```
質問ID: CPT-001
【質問】書籍ページのカスタム投稿タイプについて教えてください
- 投稿タイプ名（スラッグ）: _____
- 日本語表示名: _____
- 現在の投稿数: 約___件
- タクソノミー（カテゴリ等）: □ あり（名称：　　　　） □ なし
- 投稿タイプの登録方法: □ functions.php □ プラグイン（　　　）
```

#### 4. 既存プラグイン環境
```
質問ID: PLG-001
【質問】インストール済みプラグインについて教えてください
- プラグイン総数: 約___個
- セキュリティ系プラグイン: □ あり（名称：　　　　） □ なし
- キャッシュ系プラグイン: □ あり（名称：　　　　） □ なし
- REST API関連プラグイン: □ あり（名称：　　　　） □ なし
- JWT認証プラグイン: □ 導入済み □ 未導入
```

### B. ACFフィールド構造に関する質問

#### 5. 書籍ページのACFフィールド詳細
```
質問ID: ACF-002
【依頼】書籍ページで使用しているACFフィールドグループのエクスポートJSONをご提供ください
- エクスポート方法: ACF管理画面 → ツール → エクスポート
- 対象: 書籍ページに関連するすべてのフィールドグループ
- 形式: JSONファイル

【質問】特に重要なフィールドがあれば教えてください
- 必須フィールド: _____
- 頻繁に更新するフィールド: _____
- 他システムと連携しているフィールド: _____
```

#### 6. 販売リンク関連の既存実装
```
質問ID: LINK-001
【質問】現在、販売リンクはどのように管理されていますか？
- 管理方法: □ ACFフィールド □ カスタムHTML □ その他（　　）
- フィールド名（もしあれば）: _____
- 現在の更新方法: □ 手動入力 □ 一括更新 □ その他（　　）
```

### C. テスト環境に関する確認

#### 7. テストサーバー環境
```
質問ID: TEST-001
【質問】テストサーバーの環境について教えてください
- URL: https://test._____
- 本番環境との差異: □ 完全同一 □ 一部異なる（詳細：　　　）
- データ: □ 本番のコピー □ テストデータ □ 混在
- 更新頻度: □ 毎日 □ 週次 □ 必要時（　　　）
- アクセス制限: □ Basic認証 □ IP制限 □ その他（　　）
```

#### 8. テスト環境へのアクセス権限
```
質問ID: TEST-002
【依頼】テスト環境へのアクセス権限をご提供ください
- 管理者アカウント: □ 新規作成 □ 既存共有
- FTP/SFTP: □ 必要 □ 不要
- データベース: □ 直接アクセス可 □ 不可
- ファイル編集: □ 管理画面から □ FTP経由 □ 両方
```

### D. REST API関連の確認

#### 9. REST API設定状況
```
質問ID: API-001
【質問】WordPress REST APIの現在の設定状況を教えてください
- REST API: □ 有効 □ 無効 □ 一部制限
- 認証方式: □ なし □ Basic認証 □ OAuth □ その他（　　）
- カスタムエンドポイント: □ あり □ なし
- アクセス元制限: □ あり（詳細：　　　） □ なし
```

#### 10. 外部連携の実績
```
質問ID: API-002
【質問】過去に外部システムとの連携実績はありますか？
- 連携実績: □ あり □ なし
- ありの場合:
  - システム名: _____
  - 連携方式: □ REST API □ Webhook □ その他（　　）
  - 現在の状態: □ 稼働中 □ 停止中
```

### E. セキュリティ・運用に関する確認

#### 11. セキュリティポリシー
```
質問ID: SEC-001
【質問】セキュリティに関する要件を教えてください
- パスワードポリシー: _____
- IPアドレス制限の可否: □ 可能 □ 不可
- 許可IPアドレス（開発環境）: _____
- SSL必須: □ はい □ いいえ
- 2要素認証: □ 必須 □ 推奨 □ 不要
```

#### 12. バックアップ・復旧体制
```
質問ID: BKP-001
【質問】現在のバックアップ体制を教えてください
- バックアップ頻度: □ 毎日 □ 週次 □ その他（　　）
- バックアップ方式: □ 自動 □ 手動
- 復旧テスト: □ 定期実施 □ 未実施
- 復旧所要時間: 約___分
```

### F. 実装に関する要望・制約

#### 13. デザイン・UI要件
```
質問ID: UI-001
【質問】管理画面のUI/UXに関する要望はありますか？
- 既存のデザインガイドライン: □ あり □ なし
- カスタマイズの許容範囲: □ 自由 □ 最小限 □ 要相談
- 特定の要望: _____
```

#### 14. 運用上の制約
```
質問ID: OPS-001
【質問】運用上の制約事項があれば教えてください
- メンテナンス時間帯: _____
- 更新可能時間帯: _____
- 同時ログイン制限: □ あり（___人まで） □ なし
- その他の制約: _____
```

---

## 🔧 こちらで準備する項目

### 1. 技術検証環境
```yaml
開発環境構成:
  OS: Ubuntu 22.04 LTS
  PHP: 本番と同一バージョン
  MySQL: 本番と同一バージョン
  WordPress: 本番と同一バージョン
  
ツール:
  - Docker Compose（環境構築用）
  - Git（バージョン管理）
  - Postman（API テスト）
  - Playwright（スクレイピング）
```

### 2. プロトタイプ実装
```
準備項目:
□ ACFフィールドグループ定義（JSON）
□ REST APIエンドポイントサンプル
□ 管理画面UIモックアップ
□ データ注入クライアント（Python）
□ セキュリティ設定サンプル
```

### 3. ドキュメント類
```
作成ドキュメント:
□ API仕様書（Swagger形式）
□ データフロー図
□ エラーハンドリング一覧
□ セキュリティチェックリスト
□ テストケース一覧
```

### 4. デモンストレーション準備
```
デモ内容:
□ ローカル環境での動作デモ
□ データ注入プロセスの実演
□ 管理画面での承認フロー
□ エラー発生時の挙動
□ ロールバック手順
```

---

## 📊 テスト計画

### Phase 0でのテスト項目

#### 1. 環境確認テスト
```
□ テストサーバーへの接続確認
□ 管理画面へのログイン
□ ACFフィールドの表示確認
□ REST APIの疎通確認
□ プラグイン競合チェック
```

#### 2. 互換性テスト
```
□ ACFフィールド追加テスト
□ カスタム投稿タイプへのアクセス
□ 既存データの読み取り
□ テーマとの互換性
□ 他プラグインとの共存
```

#### 3. 基本機能テスト
```
□ JWT認証の設定
□ APIエンドポイントの作成
□ データ注入（少量）
□ 管理画面表示
□ 承認プロセス
```

---

## 📅 Phase 0 スケジュール

### Week 1 (2/1-2/7)
```
月: 管理会社への質問送付
火: 環境情報の受領・分析
水: テスト環境アクセス取得
木: 環境調査・ACF構造分析
金: 技術検証・互換性確認
```

### Week 2 (2/8-2/14)
```
月: プロトタイプ実装
火: テスト環境での動作確認
水: 管理会社とのレビュー会議
木: フィードバック反映
金: Phase 1計画の最終調整
```

---

## 📝 管理会社への依頼文案

```
件名: いずみノベルズ販売リンク自動化システム - Phase 0 実装準備のご協力のお願い

お世話になっております。

販売リンク自動化システムの実装に向けて、事前準備（Phase 0）を開始したく、
以下の情報提供とご協力をお願いいたします。

【依頼事項】
1. 添付の質問票へのご回答（可能な範囲で結構です）
2. テスト環境へのアクセス権限のご提供
3. ACFフィールドグループのエクスポートファイル
4. 2/10(水) 頃のレビュー会議の日程調整

【スケジュール】
- 2/1-2/7: 環境調査・技術検証
- 2/8-2/14: プロトタイプ作成・テスト
- 2/15〜: Phase 1 実装開始（承認後）

【重要】
今回ご提案の「半自動化方式」では、データ収集・準備は自動化しますが、
最終的な更新は管理画面で人間が確認・承認する安全な方式です。
既存システムへの影響を最小限に抑えた設計となっております。

ご不明な点がございましたら、お気軽にお問い合わせください。
何卒よろしくお願いいたします。
```

---

## ✅ Phase 0 完了条件

### 必須条件
1. ✅ すべての質問への回答取得
2. ✅ テスト環境へのアクセス確立
3. ✅ ACF構造の完全把握
4. ✅ プロトタイプの動作確認
5. ✅ 管理会社の承認取得

### 成果物
1. 📄 環境調査報告書
2. 📄 技術制約一覧
3. 📄 リスク評価（更新版）
4. 💻 動作するプロトタイプ
5. 📄 Phase 1 詳細計画書

---

**作成日**: 2025-01-31  
**重要度**: 🔴 最重要  
**次回アクション**: 管理会社への質問票送付